# キーボードマクロ

このプロジェクトは、キーボードマクロを実行する本体アプリケーションと、その設定を管理するためのWebインターフェースで構成されています。

## 機能

### 本体アプリケーション
- キーボードショートカットの監視
- カスタマイズ可能なマクロアクションの実行
- ホットキーによるマクロのトリガー
- 複数のアクションの連続実行

### 設定アプリケーション
- ホットキーの一覧表示
- 新しいホットキーの追加
- 既存のホットキーの編集
- ホットキーの削除
- 設定の自動保存

## 必要条件

- Windows 10以上
- Python 3.8以上

## インストール方法

1. リポジトリをクローンまたはダウンロードします。
2. 依存関係をインストールします：
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

### 本体アプリケーションの起動

1. `run.bat`をダブルクリックするか、コマンドプロンプトで実行します：
   ```bash
   run.bat
   ```

### 設定アプリケーションの起動

1. `start.bat`をダブルクリックするか、コマンドプロンプトで実行します：
   ```bash
   start.bat
   ```
2. ブラウザで以下のURLにアクセスします：
   ```
   http://localhost:8000
   ```

## 設定ファイルの形式

設定は`config.json`ファイルに以下の形式で保存されます：

```json
{
    "hotkeys": [
        {
            "key": "f2",
            "actions": ["right_click", "up", "up", "enter"]
        },
        {
            "key": "f3",
            "actions": ["ctrl+v", "down"]
        }
    ]
}
```

### サポートされているアクション

- キーボード入力: `a`, `b`, `c`, ... `z`, `0`-`9`, `f1`-`f12`
- 修飾キー: `ctrl`, `alt`, `shift`, `win`
- マウス操作: `left_click`, `right_click`, `middle_click`
- 方向キー: `up`, `down`, `left`, `right`
- 特殊キー: `enter`, `space`, `tab`, `backspace`, `delete`
- 組み合わせ: `ctrl+c`, `alt+tab`, `win+d`など

## プロジェクト構造

```
.
├── app.py              # 本体アプリケーション
├── server.py           # 設定アプリケーションのWebサーバ
├── config.json         # 設定ファイル
├── requirements.txt    # Python依存関係
├── run.bat             # 本体アプリケーション起動スクリプト
├── start.bat           # 設定アプリケーション起動スクリプト
├── index.html          # 設定アプリケーションのフロントエンド
└── src/
    └── App.tsx         # Reactによる設定UI（開発用）
```

## 開発者向け情報

### APIエンドポイント（server.py）

- GET `/config.json` - 現在の設定を取得
- POST `/save_config` - 設定を保存
- POST `/shutdown` - サーバーを終了

### 本体アプリケーションの拡張

新しいアクションを追加する場合は、`app.py`の該当関数を拡張してください。

## トラブルシューティング

1. アプリケーションが起動しない場合
   - 必要な依存関係がすべてインストールされているか確認
   - 管理者権限で実行してみる
   - アンチウィルスソフトの設定を確認
2. ホットキーが動作しない場合
   - 他のアプリケーションとショートカットが競合していないか確認
   - 設定ファイルの形式が正しいか確認
   - アプリケーションが実行中か確認

## ライセンス

MITライセンス